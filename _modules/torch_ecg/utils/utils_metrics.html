

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>torch_ecg.utils.utils_metrics &mdash; torch-ecg 0.0.30 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="torch-ecg 0.0.30 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> torch-ecg
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../databases.html">torch_ecg.databases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../databases.html#base-classes">Base classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.PhysioNetDataBase.html">PhysioNetDataBase</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.PhysioNetDataBase.html#torch_ecg.databases.PhysioNetDataBase"><code class="docutils literal notranslate"><span class="pre">PhysioNetDataBase</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.NSRRDataBase.html">NSRRDataBase</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.NSRRDataBase.html#torch_ecg.databases.NSRRDataBase"><code class="docutils literal notranslate"><span class="pre">NSRRDataBase</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.CPSCDataBase.html">CPSCDataBase</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.CPSCDataBase.html#torch_ecg.databases.CPSCDataBase"><code class="docutils literal notranslate"><span class="pre">CPSCDataBase</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.PSGDataBaseMixin.html">PSGDataBaseMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.PSGDataBaseMixin.html#torch_ecg.databases.PSGDataBaseMixin"><code class="docutils literal notranslate"><span class="pre">PSGDataBaseMixin</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../databases.html#physionet-database-readers">PhysioNet database readers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.AFDB.html">AFDB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.AFDB.html#torch_ecg.databases.AFDB"><code class="docutils literal notranslate"><span class="pre">AFDB</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.ApneaECG.html">ApneaECG</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.ApneaECG.html#torch_ecg.databases.ApneaECG"><code class="docutils literal notranslate"><span class="pre">ApneaECG</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.CINC2017.html">CINC2017</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.CINC2017.html#torch_ecg.databases.CINC2017"><code class="docutils literal notranslate"><span class="pre">CINC2017</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.CINC2018.html">CINC2018</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.CINC2018.html#torch_ecg.databases.CINC2018"><code class="docutils literal notranslate"><span class="pre">CINC2018</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.CINC2020.html">CINC2020</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.CINC2020.html#torch_ecg.databases.CINC2020"><code class="docutils literal notranslate"><span class="pre">CINC2020</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.CINC2021.html">CINC2021</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.CINC2021.html#torch_ecg.databases.CINC2021"><code class="docutils literal notranslate"><span class="pre">CINC2021</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.LTAFDB.html">LTAFDB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.LTAFDB.html#torch_ecg.databases.LTAFDB"><code class="docutils literal notranslate"><span class="pre">LTAFDB</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.LUDB.html">LUDB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.LUDB.html#torch_ecg.databases.LUDB"><code class="docutils literal notranslate"><span class="pre">LUDB</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.MITDB.html">MITDB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.MITDB.html#torch_ecg.databases.MITDB"><code class="docutils literal notranslate"><span class="pre">MITDB</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.QTDB.html">QTDB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.QTDB.html#torch_ecg.databases.QTDB"><code class="docutils literal notranslate"><span class="pre">QTDB</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.PTBXL.html">PTBXL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.PTBXL.html#torch_ecg.databases.PTBXL"><code class="docutils literal notranslate"><span class="pre">PTBXL</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../databases.html#cpsc-database-readers">CPSC database readers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.CPSC2018.html">CPSC2018</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.CPSC2018.html#torch_ecg.databases.CPSC2018"><code class="docutils literal notranslate"><span class="pre">CPSC2018</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.CPSC2019.html">CPSC2019</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.CPSC2019.html#torch_ecg.databases.CPSC2019"><code class="docutils literal notranslate"><span class="pre">CPSC2019</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.CPSC2020.html">CPSC2020</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.CPSC2020.html#torch_ecg.databases.CPSC2020"><code class="docutils literal notranslate"><span class="pre">CPSC2020</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.CPSC2021.html">CPSC2021</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.CPSC2021.html#torch_ecg.databases.CPSC2021"><code class="docutils literal notranslate"><span class="pre">CPSC2021</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../databases.html#nsrr-database-readers">NSRR database readers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.SHHS.html">SHHS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.SHHS.html#torch_ecg.databases.SHHS"><code class="docutils literal notranslate"><span class="pre">SHHS</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../databases.html#other-database-readers">Other database readers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.CACHET_CADB.html">CACHET_CADB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.CACHET_CADB.html#torch_ecg.databases.CACHET_CADB"><code class="docutils literal notranslate"><span class="pre">CACHET_CADB</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.SPH.html">SPH</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.SPH.html#torch_ecg.databases.SPH"><code class="docutils literal notranslate"><span class="pre">SPH</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../databases.html#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.BeatAnn.html">BeatAnn</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.BeatAnn.html#torch_ecg.databases.BeatAnn"><code class="docutils literal notranslate"><span class="pre">BeatAnn</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../databases.html#torch-ecg-databases-datasets">torch_ecg.databases.datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2020Dataset.html">CINC2020Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2020Dataset.html#torch_ecg.databases.datasets.CINC2020Dataset"><code class="docutils literal notranslate"><span class="pre">CINC2020Dataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2020Dataset.html#torch_ecg.databases.datasets.CINC2020Dataset.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">CINC2020Dataset.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2020Dataset.html#torch_ecg.databases.datasets.CINC2020Dataset.labels"><code class="docutils literal notranslate"><span class="pre">CINC2020Dataset.labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2020Dataset.html#torch_ecg.databases.datasets.CINC2020Dataset.persistence"><code class="docutils literal notranslate"><span class="pre">CINC2020Dataset.persistence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2020Dataset.html#torch_ecg.databases.datasets.CINC2020Dataset.signals"><code class="docutils literal notranslate"><span class="pre">CINC2020Dataset.signals</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2021Dataset.html">CINC2021Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2021Dataset.html#torch_ecg.databases.datasets.CINC2021Dataset"><code class="docutils literal notranslate"><span class="pre">CINC2021Dataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2021Dataset.html#torch_ecg.databases.datasets.CINC2021Dataset.empty"><code class="docutils literal notranslate"><span class="pre">CINC2021Dataset.empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2021Dataset.html#torch_ecg.databases.datasets.CINC2021Dataset.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">CINC2021Dataset.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2021Dataset.html#torch_ecg.databases.datasets.CINC2021Dataset.from_extern"><code class="docutils literal notranslate"><span class="pre">CINC2021Dataset.from_extern()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2021Dataset.html#torch_ecg.databases.datasets.CINC2021Dataset.labels"><code class="docutils literal notranslate"><span class="pre">CINC2021Dataset.labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2021Dataset.html#torch_ecg.databases.datasets.CINC2021Dataset.persistence"><code class="docutils literal notranslate"><span class="pre">CINC2021Dataset.persistence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2021Dataset.html#torch_ecg.databases.datasets.CINC2021Dataset.reload_from_extern"><code class="docutils literal notranslate"><span class="pre">CINC2021Dataset.reload_from_extern()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2021Dataset.html#torch_ecg.databases.datasets.CINC2021Dataset.signals"><code class="docutils literal notranslate"><span class="pre">CINC2021Dataset.signals</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CINC2021Dataset.html#torch_ecg.databases.datasets.CINC2021Dataset.to"><code class="docutils literal notranslate"><span class="pre">CINC2021Dataset.to()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2019Dataset.html">CPSC2019Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2019Dataset.html#torch_ecg.databases.datasets.CPSC2019Dataset"><code class="docutils literal notranslate"><span class="pre">CPSC2019Dataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2019Dataset.html#torch_ecg.databases.datasets.CPSC2019Dataset.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">CPSC2019Dataset.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2019Dataset.html#torch_ecg.databases.datasets.CPSC2019Dataset.labels"><code class="docutils literal notranslate"><span class="pre">CPSC2019Dataset.labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2019Dataset.html#torch_ecg.databases.datasets.CPSC2019Dataset.signals"><code class="docutils literal notranslate"><span class="pre">CPSC2019Dataset.signals</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2021Dataset.html">CPSC2021Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2021Dataset.html#torch_ecg.databases.datasets.CPSC2021Dataset"><code class="docutils literal notranslate"><span class="pre">CPSC2021Dataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2021Dataset.html#torch_ecg.databases.datasets.CPSC2021Dataset.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">CPSC2021Dataset.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2021Dataset.html#torch_ecg.databases.datasets.CPSC2021Dataset.load_preprocessed_data"><code class="docutils literal notranslate"><span class="pre">CPSC2021Dataset.load_preprocessed_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2021Dataset.html#torch_ecg.databases.datasets.CPSC2021Dataset.persistence"><code class="docutils literal notranslate"><span class="pre">CPSC2021Dataset.persistence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2021Dataset.html#torch_ecg.databases.datasets.CPSC2021Dataset.plot_seg"><code class="docutils literal notranslate"><span class="pre">CPSC2021Dataset.plot_seg()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.CPSC2021Dataset.html#torch_ecg.databases.datasets.CPSC2021Dataset.reset_task"><code class="docutils literal notranslate"><span class="pre">CPSC2021Dataset.reset_task()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.LUDBDataset.html">LUDBDataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.LUDBDataset.html#torch_ecg.databases.datasets.LUDBDataset"><code class="docutils literal notranslate"><span class="pre">LUDBDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.LUDBDataset.html#torch_ecg.databases.datasets.LUDBDataset.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">LUDBDataset.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.LUDBDataset.html#torch_ecg.databases.datasets.LUDBDataset.labels"><code class="docutils literal notranslate"><span class="pre">LUDBDataset.labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.LUDBDataset.html#torch_ecg.databases.datasets.LUDBDataset.signals"><code class="docutils literal notranslate"><span class="pre">LUDBDataset.signals</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.MITDBDataset.html">MITDBDataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.MITDBDataset.html#torch_ecg.databases.datasets.MITDBDataset"><code class="docutils literal notranslate"><span class="pre">MITDBDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.MITDBDataset.html#torch_ecg.databases.datasets.MITDBDataset.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">MITDBDataset.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.MITDBDataset.html#torch_ecg.databases.datasets.MITDBDataset.persistence"><code class="docutils literal notranslate"><span class="pre">MITDBDataset.persistence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.MITDBDataset.html#torch_ecg.databases.datasets.MITDBDataset.plot_seg"><code class="docutils literal notranslate"><span class="pre">MITDBDataset.plot_seg()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.databases.datasets.MITDBDataset.html#torch_ecg.databases.datasets.MITDBDataset.reset_task"><code class="docutils literal notranslate"><span class="pre">MITDBDataset.reset_task()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../models.html">torch_ecg.models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../models.html#convolutional-neural-backbones">Convolutional neural backbones</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.ResNet.html">ResNet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.ResNet.html#torch_ecg.models.ResNet"><code class="docutils literal notranslate"><span class="pre">ResNet</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.RegNet.html">RegNet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.RegNet.html#torch_ecg.models.RegNet"><code class="docutils literal notranslate"><span class="pre">RegNet</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.VGG16.html">VGG16</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.VGG16.html#torch_ecg.models.VGG16"><code class="docutils literal notranslate"><span class="pre">VGG16</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.Xception.html">Xception</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.Xception.html#torch_ecg.models.Xception"><code class="docutils literal notranslate"><span class="pre">Xception</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.DenseNet.html">DenseNet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.DenseNet.html#torch_ecg.models.DenseNet"><code class="docutils literal notranslate"><span class="pre">DenseNet</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.MobileNetV1.html">MobileNetV1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.MobileNetV1.html#torch_ecg.models.MobileNetV1"><code class="docutils literal notranslate"><span class="pre">MobileNetV1</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.MobileNetV2.html">MobileNetV2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.MobileNetV2.html#torch_ecg.models.MobileNetV2"><code class="docutils literal notranslate"><span class="pre">MobileNetV2</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.MobileNetV3.html">MobileNetV3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.MobileNetV3.html#torch_ecg.models.MobileNetV3"><code class="docutils literal notranslate"><span class="pre">MobileNetV3</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.MultiScopicCNN.html">MultiScopicCNN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.MultiScopicCNN.html#torch_ecg.models.MultiScopicCNN"><code class="docutils literal notranslate"><span class="pre">MultiScopicCNN</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../models.html#downstream-task-models">Downstream task models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.ECG_UNET.html">ECG_UNET</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.ECG_UNET.html#torch_ecg.models.ECG_UNET"><code class="docutils literal notranslate"><span class="pre">ECG_UNET</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.ECG_SUBTRACT_UNET.html">ECG_SUBTRACT_UNET</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.ECG_SUBTRACT_UNET.html#torch_ecg.models.ECG_SUBTRACT_UNET"><code class="docutils literal notranslate"><span class="pre">ECG_SUBTRACT_UNET</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.ECG_CRNN.html">ECG_CRNN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.ECG_CRNN.html#torch_ecg.models.ECG_CRNN"><code class="docutils literal notranslate"><span class="pre">ECG_CRNN</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.ECG_SEQ_LAB_NET.html">ECG_SEQ_LAB_NET</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.ECG_SEQ_LAB_NET.html#torch_ecg.models.ECG_SEQ_LAB_NET"><code class="docutils literal notranslate"><span class="pre">ECG_SEQ_LAB_NET</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.RR_LSTM.html">RR_LSTM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.RR_LSTM.html#torch_ecg.models.RR_LSTM"><code class="docutils literal notranslate"><span class="pre">RR_LSTM</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../models.html#saliency-analysis">Saliency analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.GradCam.html">GradCam</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.GradCam.html#torch_ecg.models.GradCam"><code class="docutils literal notranslate"><span class="pre">GradCam</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../losses.html">torch_ecg.models.loss</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.WeightedBCELoss.html">WeightedBCELoss</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.WeightedBCELoss.html#torch_ecg.models.loss.WeightedBCELoss"><code class="docutils literal notranslate"><span class="pre">WeightedBCELoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.WeightedBCELoss.html#torch_ecg.models.loss.WeightedBCELoss.forward"><code class="docutils literal notranslate"><span class="pre">WeightedBCELoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.BCEWithLogitsWithClassWeightLoss.html">BCEWithLogitsWithClassWeightLoss</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.BCEWithLogitsWithClassWeightLoss.html#torch_ecg.models.loss.BCEWithLogitsWithClassWeightLoss"><code class="docutils literal notranslate"><span class="pre">BCEWithLogitsWithClassWeightLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.BCEWithLogitsWithClassWeightLoss.html#torch_ecg.models.loss.BCEWithLogitsWithClassWeightLoss.forward"><code class="docutils literal notranslate"><span class="pre">BCEWithLogitsWithClassWeightLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.MaskedBCEWithLogitsLoss.html">MaskedBCEWithLogitsLoss</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.MaskedBCEWithLogitsLoss.html#torch_ecg.models.loss.MaskedBCEWithLogitsLoss"><code class="docutils literal notranslate"><span class="pre">MaskedBCEWithLogitsLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.MaskedBCEWithLogitsLoss.html#torch_ecg.models.loss.MaskedBCEWithLogitsLoss.forward"><code class="docutils literal notranslate"><span class="pre">MaskedBCEWithLogitsLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.FocalLoss.html">FocalLoss</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.FocalLoss.html#torch_ecg.models.loss.FocalLoss"><code class="docutils literal notranslate"><span class="pre">FocalLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.FocalLoss.html#torch_ecg.models.loss.FocalLoss.forward"><code class="docutils literal notranslate"><span class="pre">FocalLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.AsymmetricLoss.html">AsymmetricLoss</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.AsymmetricLoss.html#torch_ecg.models.loss.AsymmetricLoss"><code class="docutils literal notranslate"><span class="pre">AsymmetricLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.AsymmetricLoss.html#torch_ecg.models.loss.AsymmetricLoss.forward"><code class="docutils literal notranslate"><span class="pre">AsymmetricLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.setup_criterion.html">torch_ecg.models.loss.setup_criterion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.models.loss.setup_criterion.html#torch_ecg.models.loss.setup_criterion"><code class="docutils literal notranslate"><span class="pre">setup_criterion()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../augmenters.html">torch_ecg.augmenters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.AugmenterManager.html">AugmenterManager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.AugmenterManager.html#torch_ecg.augmenters.AugmenterManager"><code class="docutils literal notranslate"><span class="pre">AugmenterManager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.AugmenterManager.html#torch_ecg.augmenters.AugmenterManager.augmenters"><code class="docutils literal notranslate"><span class="pre">AugmenterManager.augmenters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.AugmenterManager.html#torch_ecg.augmenters.AugmenterManager.extra_repr"><code class="docutils literal notranslate"><span class="pre">AugmenterManager.extra_repr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.AugmenterManager.html#torch_ecg.augmenters.AugmenterManager.forward"><code class="docutils literal notranslate"><span class="pre">AugmenterManager.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.AugmenterManager.html#torch_ecg.augmenters.AugmenterManager.from_config"><code class="docutils literal notranslate"><span class="pre">AugmenterManager.from_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.AugmenterManager.html#torch_ecg.augmenters.AugmenterManager.rearrange"><code class="docutils literal notranslate"><span class="pre">AugmenterManager.rearrange()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.Augmenter.html">Augmenter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.Augmenter.html#torch_ecg.augmenters.Augmenter"><code class="docutils literal notranslate"><span class="pre">Augmenter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.Augmenter.html#torch_ecg.augmenters.Augmenter.forward"><code class="docutils literal notranslate"><span class="pre">Augmenter.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.Augmenter.html#torch_ecg.augmenters.Augmenter.get_indices"><code class="docutils literal notranslate"><span class="pre">Augmenter.get_indices()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.BaselineWanderAugmenter.html">BaselineWanderAugmenter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.BaselineWanderAugmenter.html#torch_ecg.augmenters.BaselineWanderAugmenter"><code class="docutils literal notranslate"><span class="pre">BaselineWanderAugmenter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.BaselineWanderAugmenter.html#torch_ecg.augmenters.BaselineWanderAugmenter.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">BaselineWanderAugmenter.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.BaselineWanderAugmenter.html#torch_ecg.augmenters.BaselineWanderAugmenter.forward"><code class="docutils literal notranslate"><span class="pre">BaselineWanderAugmenter.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.CutMix.html">CutMix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.CutMix.html#torch_ecg.augmenters.CutMix"><code class="docutils literal notranslate"><span class="pre">CutMix</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.CutMix.html#torch_ecg.augmenters.CutMix.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">CutMix.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.CutMix.html#torch_ecg.augmenters.CutMix.forward"><code class="docutils literal notranslate"><span class="pre">CutMix.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.LabelSmooth.html">LabelSmooth</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.LabelSmooth.html#torch_ecg.augmenters.LabelSmooth"><code class="docutils literal notranslate"><span class="pre">LabelSmooth</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.LabelSmooth.html#torch_ecg.augmenters.LabelSmooth.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">LabelSmooth.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.LabelSmooth.html#torch_ecg.augmenters.LabelSmooth.forward"><code class="docutils literal notranslate"><span class="pre">LabelSmooth.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.Mixup.html">Mixup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.Mixup.html#torch_ecg.augmenters.Mixup"><code class="docutils literal notranslate"><span class="pre">Mixup</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.Mixup.html#torch_ecg.augmenters.Mixup.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">Mixup.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.Mixup.html#torch_ecg.augmenters.Mixup.forward"><code class="docutils literal notranslate"><span class="pre">Mixup.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomFlip.html">RandomFlip</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomFlip.html#torch_ecg.augmenters.RandomFlip"><code class="docutils literal notranslate"><span class="pre">RandomFlip</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomFlip.html#torch_ecg.augmenters.RandomFlip.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">RandomFlip.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomFlip.html#torch_ecg.augmenters.RandomFlip.forward"><code class="docutils literal notranslate"><span class="pre">RandomFlip.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomMasking.html">RandomMasking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomMasking.html#torch_ecg.augmenters.RandomMasking"><code class="docutils literal notranslate"><span class="pre">RandomMasking</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomMasking.html#torch_ecg.augmenters.RandomMasking.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">RandomMasking.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomMasking.html#torch_ecg.augmenters.RandomMasking.forward"><code class="docutils literal notranslate"><span class="pre">RandomMasking.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomRenormalize.html">RandomRenormalize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomRenormalize.html#torch_ecg.augmenters.RandomRenormalize"><code class="docutils literal notranslate"><span class="pre">RandomRenormalize</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomRenormalize.html#torch_ecg.augmenters.RandomRenormalize.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">RandomRenormalize.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.RandomRenormalize.html#torch_ecg.augmenters.RandomRenormalize.forward"><code class="docutils literal notranslate"><span class="pre">RandomRenormalize.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.StretchCompress.html">StretchCompress</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.StretchCompress.html#torch_ecg.augmenters.StretchCompress"><code class="docutils literal notranslate"><span class="pre">StretchCompress</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.StretchCompress.html#torch_ecg.augmenters.StretchCompress.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">StretchCompress.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.StretchCompress.html#torch_ecg.augmenters.StretchCompress.forward"><code class="docutils literal notranslate"><span class="pre">StretchCompress.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.StretchCompressOffline.html">StretchCompressOffline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.StretchCompressOffline.html#torch_ecg.augmenters.StretchCompressOffline"><code class="docutils literal notranslate"><span class="pre">StretchCompressOffline</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.StretchCompressOffline.html#torch_ecg.augmenters.StretchCompressOffline.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">StretchCompressOffline.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.augmenters.StretchCompressOffline.html#torch_ecg.augmenters.StretchCompressOffline.generate"><code class="docutils literal notranslate"><span class="pre">StretchCompressOffline.generate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../preprocessors.html">torch_ecg._preprocessors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.PreprocManager.html">PreprocManager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.PreprocManager.html#torch_ecg._preprocessors.PreprocManager"><code class="docutils literal notranslate"><span class="pre">PreprocManager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.PreprocManager.html#torch_ecg._preprocessors.PreprocManager.add_"><code class="docutils literal notranslate"><span class="pre">PreprocManager.add_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.PreprocManager.html#torch_ecg._preprocessors.PreprocManager.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">PreprocManager.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.PreprocManager.html#torch_ecg._preprocessors.PreprocManager.from_config"><code class="docutils literal notranslate"><span class="pre">PreprocManager.from_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.PreprocManager.html#torch_ecg._preprocessors.PreprocManager.rearrange"><code class="docutils literal notranslate"><span class="pre">PreprocManager.rearrange()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.PreProcessor.html">PreProcessor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.PreProcessor.html#torch_ecg._preprocessors.PreProcessor"><code class="docutils literal notranslate"><span class="pre">PreProcessor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.PreProcessor.html#torch_ecg._preprocessors.PreProcessor.apply"><code class="docutils literal notranslate"><span class="pre">PreProcessor.apply()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.BandPass.html">BandPass</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.BandPass.html#torch_ecg._preprocessors.BandPass"><code class="docutils literal notranslate"><span class="pre">BandPass</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.BandPass.html#torch_ecg._preprocessors.BandPass.apply"><code class="docutils literal notranslate"><span class="pre">BandPass.apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.BandPass.html#torch_ecg._preprocessors.BandPass.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">BandPass.extra_repr_keys()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.BaselineRemove.html">BaselineRemove</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.BaselineRemove.html#torch_ecg._preprocessors.BaselineRemove"><code class="docutils literal notranslate"><span class="pre">BaselineRemove</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.BaselineRemove.html#torch_ecg._preprocessors.BaselineRemove.apply"><code class="docutils literal notranslate"><span class="pre">BaselineRemove.apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.BaselineRemove.html#torch_ecg._preprocessors.BaselineRemove.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">BaselineRemove.extra_repr_keys()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.Normalize.html">Normalize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.Normalize.html#torch_ecg._preprocessors.Normalize"><code class="docutils literal notranslate"><span class="pre">Normalize</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.Normalize.html#torch_ecg._preprocessors.Normalize.apply"><code class="docutils literal notranslate"><span class="pre">Normalize.apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.Normalize.html#torch_ecg._preprocessors.Normalize.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">Normalize.extra_repr_keys()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.MinMaxNormalize.html">MinMaxNormalize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.MinMaxNormalize.html#torch_ecg._preprocessors.MinMaxNormalize"><code class="docutils literal notranslate"><span class="pre">MinMaxNormalize</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.MinMaxNormalize.html#torch_ecg._preprocessors.MinMaxNormalize.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">MinMaxNormalize.extra_repr_keys()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.NaiveNormalize.html">NaiveNormalize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.NaiveNormalize.html#torch_ecg._preprocessors.NaiveNormalize"><code class="docutils literal notranslate"><span class="pre">NaiveNormalize</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.NaiveNormalize.html#torch_ecg._preprocessors.NaiveNormalize.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">NaiveNormalize.extra_repr_keys()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.ZScoreNormalize.html">ZScoreNormalize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.ZScoreNormalize.html#torch_ecg._preprocessors.ZScoreNormalize"><code class="docutils literal notranslate"><span class="pre">ZScoreNormalize</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.ZScoreNormalize.html#torch_ecg._preprocessors.ZScoreNormalize.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">ZScoreNormalize.extra_repr_keys()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.Resample.html">Resample</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.Resample.html#torch_ecg._preprocessors.Resample"><code class="docutils literal notranslate"><span class="pre">Resample</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.Resample.html#torch_ecg._preprocessors.Resample.apply"><code class="docutils literal notranslate"><span class="pre">Resample.apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.Resample.html#torch_ecg._preprocessors.Resample.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">Resample.extra_repr_keys()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.preprocess_multi_lead_signal.html">torch_ecg._preprocessors.preprocess_multi_lead_signal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.preprocess_multi_lead_signal.html#torch_ecg._preprocessors.preprocess_multi_lead_signal"><code class="docutils literal notranslate"><span class="pre">preprocess_multi_lead_signal()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.preprocess_single_lead_signal.html">torch_ecg._preprocessors.preprocess_single_lead_signal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg._preprocessors.preprocess_single_lead_signal.html#torch_ecg._preprocessors.preprocess_single_lead_signal"><code class="docutils literal notranslate"><span class="pre">preprocess_single_lead_signal()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../preprocessors.html#id1">torch_ecg.preprocessors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.PreprocManager.html">PreprocManager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.PreprocManager.html#torch_ecg.preprocessors.PreprocManager"><code class="docutils literal notranslate"><span class="pre">PreprocManager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.PreprocManager.html#torch_ecg.preprocessors.PreprocManager.add_"><code class="docutils literal notranslate"><span class="pre">PreprocManager.add_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.PreprocManager.html#torch_ecg.preprocessors.PreprocManager.extra_repr_keys"><code class="docutils literal notranslate"><span class="pre">PreprocManager.extra_repr_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.PreprocManager.html#torch_ecg.preprocessors.PreprocManager.forward"><code class="docutils literal notranslate"><span class="pre">PreprocManager.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.PreprocManager.html#torch_ecg.preprocessors.PreprocManager.from_config"><code class="docutils literal notranslate"><span class="pre">PreprocManager.from_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.PreprocManager.html#torch_ecg.preprocessors.PreprocManager.rearrange"><code class="docutils literal notranslate"><span class="pre">PreprocManager.rearrange()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.BandPass.html">BandPass</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.BandPass.html#torch_ecg.preprocessors.BandPass"><code class="docutils literal notranslate"><span class="pre">BandPass</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.BandPass.html#torch_ecg.preprocessors.BandPass.forward"><code class="docutils literal notranslate"><span class="pre">BandPass.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.BaselineRemove.html">BaselineRemove</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.BaselineRemove.html#torch_ecg.preprocessors.BaselineRemove"><code class="docutils literal notranslate"><span class="pre">BaselineRemove</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.BaselineRemove.html#torch_ecg.preprocessors.BaselineRemove.forward"><code class="docutils literal notranslate"><span class="pre">BaselineRemove.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.Normalize.html">Normalize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.Normalize.html#torch_ecg.preprocessors.Normalize"><code class="docutils literal notranslate"><span class="pre">Normalize</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.Normalize.html#torch_ecg.preprocessors.Normalize.forward"><code class="docutils literal notranslate"><span class="pre">Normalize.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.MinMaxNormalize.html">MinMaxNormalize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.MinMaxNormalize.html#torch_ecg.preprocessors.MinMaxNormalize"><code class="docutils literal notranslate"><span class="pre">MinMaxNormalize</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.NaiveNormalize.html">NaiveNormalize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.NaiveNormalize.html#torch_ecg.preprocessors.NaiveNormalize"><code class="docutils literal notranslate"><span class="pre">NaiveNormalize</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.ZScoreNormalize.html">ZScoreNormalize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.ZScoreNormalize.html#torch_ecg.preprocessors.ZScoreNormalize"><code class="docutils literal notranslate"><span class="pre">ZScoreNormalize</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.Resample.html">Resample</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.Resample.html#torch_ecg.preprocessors.Resample"><code class="docutils literal notranslate"><span class="pre">Resample</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.preprocessors.Resample.html#torch_ecg.preprocessors.Resample.forward"><code class="docutils literal notranslate"><span class="pre">Resample.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../components.html">torch_ecg.components</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../components.html#input-classes">Input classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.InputConfig.html">InputConfig</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.InputConfig.html#torch_ecg.components.InputConfig"><code class="docutils literal notranslate"><span class="pre">InputConfig</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.WaveformInput.html">WaveformInput</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.WaveformInput.html#torch_ecg.components.WaveformInput"><code class="docutils literal notranslate"><span class="pre">WaveformInput</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.FFTInput.html">FFTInput</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.FFTInput.html#torch_ecg.components.FFTInput"><code class="docutils literal notranslate"><span class="pre">FFTInput</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.SpectrogramInput.html">SpectrogramInput</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.SpectrogramInput.html#torch_ecg.components.SpectrogramInput"><code class="docutils literal notranslate"><span class="pre">SpectrogramInput</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../components.html#output-classes">Output classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.ClassificationOutput.html">ClassificationOutput</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.ClassificationOutput.html#torch_ecg.components.ClassificationOutput"><code class="docutils literal notranslate"><span class="pre">ClassificationOutput</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.MultiLabelClassificationOutput.html">MultiLabelClassificationOutput</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.MultiLabelClassificationOutput.html#torch_ecg.components.MultiLabelClassificationOutput"><code class="docutils literal notranslate"><span class="pre">MultiLabelClassificationOutput</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.SequenceTaggingOutput.html">SequenceTaggingOutput</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.SequenceTaggingOutput.html#torch_ecg.components.SequenceTaggingOutput"><code class="docutils literal notranslate"><span class="pre">SequenceTaggingOutput</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.SequenceLabellingOutput.html">SequenceLabellingOutput</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.SequenceLabellingOutput.html#torch_ecg.components.SequenceLabellingOutput"><code class="docutils literal notranslate"><span class="pre">SequenceLabellingOutput</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.WaveDelineationOutput.html">WaveDelineationOutput</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.WaveDelineationOutput.html#torch_ecg.components.WaveDelineationOutput"><code class="docutils literal notranslate"><span class="pre">WaveDelineationOutput</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.RPeaksDetectionOutput.html">RPeaksDetectionOutput</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.RPeaksDetectionOutput.html#torch_ecg.components.RPeaksDetectionOutput"><code class="docutils literal notranslate"><span class="pre">RPeaksDetectionOutput</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../components.html#loggers">Loggers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.LoggerManager.html">LoggerManager</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.LoggerManager.html#torch_ecg.components.LoggerManager"><code class="docutils literal notranslate"><span class="pre">LoggerManager</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../components.html#metrics">Metrics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.ClassificationMetrics.html">ClassificationMetrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.ClassificationMetrics.html#torch_ecg.components.ClassificationMetrics"><code class="docutils literal notranslate"><span class="pre">ClassificationMetrics</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.RPeaksDetectionMetrics.html">RPeaksDetectionMetrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.RPeaksDetectionMetrics.html#torch_ecg.components.RPeaksDetectionMetrics"><code class="docutils literal notranslate"><span class="pre">RPeaksDetectionMetrics</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.WaveDelineationMetrics.html">WaveDelineationMetrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.WaveDelineationMetrics.html#torch_ecg.components.WaveDelineationMetrics"><code class="docutils literal notranslate"><span class="pre">WaveDelineationMetrics</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../components.html#trainer">Trainer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.components.BaseTrainer.html">BaseTrainer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.components.BaseTrainer.html#torch_ecg.components.BaseTrainer"><code class="docutils literal notranslate"><span class="pre">BaseTrainer</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../utils.html">torch_ecg.utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../utils.html#neural-network-auxiliary-functions-and-classes">Neural network auxiliary functions and classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.extend_predictions.html">torch_ecg.utils.extend_predictions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.extend_predictions.html#torch_ecg.utils.extend_predictions"><code class="docutils literal notranslate"><span class="pre">extend_predictions()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_output_shape.html">torch_ecg.utils.compute_output_shape</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_output_shape.html#torch_ecg.utils.compute_output_shape"><code class="docutils literal notranslate"><span class="pre">compute_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_conv_output_shape.html">torch_ecg.utils.compute_conv_output_shape</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_conv_output_shape.html#torch_ecg.utils.compute_conv_output_shape"><code class="docutils literal notranslate"><span class="pre">compute_conv_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_deconv_output_shape.html">torch_ecg.utils.compute_deconv_output_shape</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_deconv_output_shape.html#torch_ecg.utils.compute_deconv_output_shape"><code class="docutils literal notranslate"><span class="pre">compute_deconv_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_maxpool_output_shape.html">torch_ecg.utils.compute_maxpool_output_shape</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_maxpool_output_shape.html#torch_ecg.utils.compute_maxpool_output_shape"><code class="docutils literal notranslate"><span class="pre">compute_maxpool_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_avgpool_output_shape.html">torch_ecg.utils.compute_avgpool_output_shape</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_avgpool_output_shape.html#torch_ecg.utils.compute_avgpool_output_shape"><code class="docutils literal notranslate"><span class="pre">compute_avgpool_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_sequential_output_shape.html">torch_ecg.utils.compute_sequential_output_shape</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_sequential_output_shape.html#torch_ecg.utils.compute_sequential_output_shape"><code class="docutils literal notranslate"><span class="pre">compute_sequential_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_module_size.html">torch_ecg.utils.compute_module_size</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_module_size.html#torch_ecg.utils.compute_module_size"><code class="docutils literal notranslate"><span class="pre">compute_module_size()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.default_collate_fn.html">torch_ecg.utils.default_collate_fn</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.default_collate_fn.html#torch_ecg.utils.default_collate_fn"><code class="docutils literal notranslate"><span class="pre">default_collate_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_receptive_field.html">torch_ecg.utils.compute_receptive_field</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_receptive_field.html#torch_ecg.utils.compute_receptive_field"><code class="docutils literal notranslate"><span class="pre">compute_receptive_field()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.adjust_cnn_filter_lengths.html">torch_ecg.utils.adjust_cnn_filter_lengths</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.adjust_cnn_filter_lengths.html#torch_ecg.utils.adjust_cnn_filter_lengths"><code class="docutils literal notranslate"><span class="pre">adjust_cnn_filter_lengths()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.SizeMixin.html">SizeMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.SizeMixin.html#torch_ecg.utils.SizeMixin"><code class="docutils literal notranslate"><span class="pre">SizeMixin</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.CkptMixin.html">CkptMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.CkptMixin.html#torch_ecg.utils.CkptMixin"><code class="docutils literal notranslate"><span class="pre">CkptMixin</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../utils.html#signal-processing-functions">Signal processing functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.smooth.html">torch_ecg.utils.smooth</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.smooth.html#torch_ecg.utils.smooth"><code class="docutils literal notranslate"><span class="pre">smooth()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.resample_irregular_timeseries.html">torch_ecg.utils.resample_irregular_timeseries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.resample_irregular_timeseries.html#torch_ecg.utils.resample_irregular_timeseries"><code class="docutils literal notranslate"><span class="pre">resample_irregular_timeseries()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.detect_peaks.html">torch_ecg.utils.detect_peaks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.detect_peaks.html#torch_ecg.utils.detect_peaks"><code class="docutils literal notranslate"><span class="pre">detect_peaks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.remove_spikes_naive.html">torch_ecg.utils.remove_spikes_naive</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.remove_spikes_naive.html#torch_ecg.utils.remove_spikes_naive"><code class="docutils literal notranslate"><span class="pre">remove_spikes_naive()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.butter_bandpass_filter.html">torch_ecg.utils.butter_bandpass_filter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.butter_bandpass_filter.html#torch_ecg.utils.butter_bandpass_filter"><code class="docutils literal notranslate"><span class="pre">butter_bandpass_filter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_ampl.html">torch_ecg.utils.get_ampl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_ampl.html#torch_ecg.utils.get_ampl"><code class="docutils literal notranslate"><span class="pre">get_ampl()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.normalize.html">torch_ecg.utils.normalize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.normalize.html#torch_ecg.utils.normalize"><code class="docutils literal notranslate"><span class="pre">normalize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.normalize_t.html">torch_ecg.utils.normalize_t</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.normalize_t.html#torch_ecg.utils.normalize_t"><code class="docutils literal notranslate"><span class="pre">normalize_t()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.resample_t.html">torch_ecg.utils.resample_t</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.resample_t.html#torch_ecg.utils.resample_t"><code class="docutils literal notranslate"><span class="pre">resample_t()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../utils.html#data-operations">Data operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_mask.html">torch_ecg.utils.get_mask</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_mask.html#torch_ecg.utils.get_mask"><code class="docutils literal notranslate"><span class="pre">get_mask()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.class_weight_to_sample_weight.html">torch_ecg.utils.class_weight_to_sample_weight</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.class_weight_to_sample_weight.html#torch_ecg.utils.class_weight_to_sample_weight"><code class="docutils literal notranslate"><span class="pre">class_weight_to_sample_weight()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.ensure_lead_fmt.html">torch_ecg.utils.ensure_lead_fmt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.ensure_lead_fmt.html#torch_ecg.utils.ensure_lead_fmt"><code class="docutils literal notranslate"><span class="pre">ensure_lead_fmt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.ensure_siglen.html">torch_ecg.utils.ensure_siglen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.ensure_siglen.html#torch_ecg.utils.ensure_siglen"><code class="docutils literal notranslate"><span class="pre">ensure_siglen()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.masks_to_waveforms.html">torch_ecg.utils.masks_to_waveforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.masks_to_waveforms.html#torch_ecg.utils.masks_to_waveforms"><code class="docutils literal notranslate"><span class="pre">masks_to_waveforms()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.mask_to_intervals.html">torch_ecg.utils.mask_to_intervals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.mask_to_intervals.html#torch_ecg.utils.mask_to_intervals"><code class="docutils literal notranslate"><span class="pre">mask_to_intervals()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.uniform.html">torch_ecg.utils.uniform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.uniform.html#torch_ecg.utils.uniform"><code class="docutils literal notranslate"><span class="pre">uniform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.stratified_train_test_split.html">torch_ecg.utils.stratified_train_test_split</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.stratified_train_test_split.html#torch_ecg.utils.stratified_train_test_split"><code class="docutils literal notranslate"><span class="pre">stratified_train_test_split()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.one_hot_encode.html">torch_ecg.utils.one_hot_encode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.one_hot_encode.html#torch_ecg.utils.one_hot_encode"><code class="docutils literal notranslate"><span class="pre">one_hot_encode()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.generate_weight_mask.html">torch_ecg.utils.generate_weight_mask</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.generate_weight_mask.html#torch_ecg.utils.generate_weight_mask"><code class="docutils literal notranslate"><span class="pre">generate_weight_mask()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../utils.html#interval-operations">Interval operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.overlaps.html">torch_ecg.utils.overlaps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.overlaps.html#torch_ecg.utils.overlaps"><code class="docutils literal notranslate"><span class="pre">overlaps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.validate_interval.html">torch_ecg.utils.validate_interval</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.validate_interval.html#torch_ecg.utils.validate_interval"><code class="docutils literal notranslate"><span class="pre">validate_interval()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.in_interval.html">torch_ecg.utils.in_interval</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.in_interval.html#torch_ecg.utils.in_interval"><code class="docutils literal notranslate"><span class="pre">in_interval()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.in_generalized_interval.html">torch_ecg.utils.in_generalized_interval</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.in_generalized_interval.html#torch_ecg.utils.in_generalized_interval"><code class="docutils literal notranslate"><span class="pre">in_generalized_interval()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.intervals_union.html">torch_ecg.utils.intervals_union</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.intervals_union.html#torch_ecg.utils.intervals_union"><code class="docutils literal notranslate"><span class="pre">intervals_union()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.generalized_intervals_union.html">torch_ecg.utils.generalized_intervals_union</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.generalized_intervals_union.html#torch_ecg.utils.generalized_intervals_union"><code class="docutils literal notranslate"><span class="pre">generalized_intervals_union()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.intervals_intersection.html">torch_ecg.utils.intervals_intersection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.intervals_intersection.html#torch_ecg.utils.intervals_intersection"><code class="docutils literal notranslate"><span class="pre">intervals_intersection()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.generalized_intervals_intersection.html">torch_ecg.utils.generalized_intervals_intersection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.generalized_intervals_intersection.html#torch_ecg.utils.generalized_intervals_intersection"><code class="docutils literal notranslate"><span class="pre">generalized_intervals_intersection()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.generalized_interval_complement.html">torch_ecg.utils.generalized_interval_complement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.generalized_interval_complement.html#torch_ecg.utils.generalized_interval_complement"><code class="docutils literal notranslate"><span class="pre">generalized_interval_complement()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_optimal_covering.html">torch_ecg.utils.get_optimal_covering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_optimal_covering.html#torch_ecg.utils.get_optimal_covering"><code class="docutils literal notranslate"><span class="pre">get_optimal_covering()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.interval_len.html">torch_ecg.utils.interval_len</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.interval_len.html#torch_ecg.utils.interval_len"><code class="docutils literal notranslate"><span class="pre">interval_len()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.generalized_interval_len.html">torch_ecg.utils.generalized_interval_len</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.generalized_interval_len.html#torch_ecg.utils.generalized_interval_len"><code class="docutils literal notranslate"><span class="pre">generalized_interval_len()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.find_extrema.html">torch_ecg.utils.find_extrema</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.find_extrema.html#torch_ecg.utils.find_extrema"><code class="docutils literal notranslate"><span class="pre">find_extrema()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.is_intersect.html">torch_ecg.utils.is_intersect</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.is_intersect.html#torch_ecg.utils.is_intersect"><code class="docutils literal notranslate"><span class="pre">is_intersect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.max_disjoint_covering.html">torch_ecg.utils.max_disjoint_covering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.max_disjoint_covering.html#torch_ecg.utils.max_disjoint_covering"><code class="docutils literal notranslate"><span class="pre">max_disjoint_covering()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../utils.html#metrics-computations">Metrics computations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.top_n_accuracy.html">torch_ecg.utils.top_n_accuracy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.top_n_accuracy.html#torch_ecg.utils.top_n_accuracy"><code class="docutils literal notranslate"><span class="pre">top_n_accuracy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.confusion_matrix.html">torch_ecg.utils.confusion_matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.confusion_matrix.html#torch_ecg.utils.confusion_matrix"><code class="docutils literal notranslate"><span class="pre">confusion_matrix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.ovr_confusion_matrix.html">torch_ecg.utils.ovr_confusion_matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.ovr_confusion_matrix.html#torch_ecg.utils.ovr_confusion_matrix"><code class="docutils literal notranslate"><span class="pre">ovr_confusion_matrix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.metrics_from_confusion_matrix.html">torch_ecg.utils.metrics_from_confusion_matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.metrics_from_confusion_matrix.html#torch_ecg.utils.metrics_from_confusion_matrix"><code class="docutils literal notranslate"><span class="pre">metrics_from_confusion_matrix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_wave_delineation_metrics.html">torch_ecg.utils.compute_wave_delineation_metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.compute_wave_delineation_metrics.html#torch_ecg.utils.compute_wave_delineation_metrics"><code class="docutils literal notranslate"><span class="pre">compute_wave_delineation_metrics()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.QRS_score.html">torch_ecg.utils.QRS_score</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.QRS_score.html#torch_ecg.utils.QRS_score"><code class="docutils literal notranslate"><span class="pre">QRS_score()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../utils.html#decorators-and-mixins">Decorators and Mixins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.add_docstring.html">torch_ecg.utils.add_docstring</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.add_docstring.html#torch_ecg.utils.add_docstring"><code class="docutils literal notranslate"><span class="pre">add_docstring()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.remove_parameters_returns_from_docstring.html">torch_ecg.utils.remove_parameters_returns_from_docstring</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.remove_parameters_returns_from_docstring.html#torch_ecg.utils.remove_parameters_returns_from_docstring"><code class="docutils literal notranslate"><span class="pre">remove_parameters_returns_from_docstring()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.default_class_repr.html">torch_ecg.utils.default_class_repr</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.default_class_repr.html#torch_ecg.utils.default_class_repr"><code class="docutils literal notranslate"><span class="pre">default_class_repr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.ReprMixin.html">ReprMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.ReprMixin.html#torch_ecg.utils.ReprMixin"><code class="docutils literal notranslate"><span class="pre">ReprMixin</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.CitationMixin.html">CitationMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.CitationMixin.html#torch_ecg.utils.CitationMixin"><code class="docutils literal notranslate"><span class="pre">CitationMixin</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_kwargs.html">torch_ecg.utils.get_kwargs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_kwargs.html#torch_ecg.utils.get_kwargs"><code class="docutils literal notranslate"><span class="pre">get_kwargs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_required_args.html">torch_ecg.utils.get_required_args</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_required_args.html#torch_ecg.utils.get_required_args"><code class="docutils literal notranslate"><span class="pre">get_required_args()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.add_kwargs.html">torch_ecg.utils.add_kwargs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.add_kwargs.html#torch_ecg.utils.add_kwargs"><code class="docutils literal notranslate"><span class="pre">add_kwargs()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../utils.html#path-operations">Path operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_record_list_recursive3.html">torch_ecg.utils.get_record_list_recursive3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_record_list_recursive3.html#torch_ecg.utils.get_record_list_recursive3"><code class="docutils literal notranslate"><span class="pre">get_record_list_recursive3()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../utils.html#string-operations">String operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.dict_to_str.html">torch_ecg.utils.dict_to_str</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.dict_to_str.html#torch_ecg.utils.dict_to_str"><code class="docutils literal notranslate"><span class="pre">dict_to_str()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.str2bool.html">torch_ecg.utils.str2bool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.str2bool.html#torch_ecg.utils.str2bool"><code class="docutils literal notranslate"><span class="pre">str2bool()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.nildent.html">torch_ecg.utils.nildent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.nildent.html#torch_ecg.utils.nildent"><code class="docutils literal notranslate"><span class="pre">nildent()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_date_str.html">torch_ecg.utils.get_date_str</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.get_date_str.html#torch_ecg.utils.get_date_str"><code class="docutils literal notranslate"><span class="pre">get_date_str()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../utils.html#visualization-functions">Visualization functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.ecg_plot.html">torch_ecg.utils.ecg_plot</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.ecg_plot.html#torch_ecg.utils.ecg_plot"><code class="docutils literal notranslate"><span class="pre">ecg_plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../utils.html#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.init_logger.html">torch_ecg.utils.init_logger</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.init_logger.html#torch_ecg.utils.init_logger"><code class="docutils literal notranslate"><span class="pre">init_logger()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.list_sum.html">torch_ecg.utils.list_sum</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.list_sum.html#torch_ecg.utils.list_sum"><code class="docutils literal notranslate"><span class="pre">list_sum()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.dicts_equal.html">torch_ecg.utils.dicts_equal</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.dicts_equal.html#torch_ecg.utils.dicts_equal"><code class="docutils literal notranslate"><span class="pre">dicts_equal()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.MovingAverage.html">MovingAverage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.MovingAverage.html#torch_ecg.utils.MovingAverage"><code class="docutils literal notranslate"><span class="pre">MovingAverage</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.Timer.html">Timer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.Timer.html#torch_ecg.utils.Timer"><code class="docutils literal notranslate"><span class="pre">Timer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.timeout.html">torch_ecg.utils.timeout</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.timeout.html#torch_ecg.utils.timeout"><code class="docutils literal notranslate"><span class="pre">timeout()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.np_topk.html">torch_ecg.utils.np_topk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.np_topk.html#torch_ecg.utils.np_topk"><code class="docutils literal notranslate"><span class="pre">np_topk()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/torch_ecg.utils.select_k.html">torch_ecg.utils.select_k</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/torch_ecg.utils.select_k.html#torch_ecg.utils.select_k"><code class="docutils literal notranslate"><span class="pre">select_k()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">torch-ecg</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>torch_ecg.utils.utils_metrics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/DeepPSP/torch_ecg/blob/master/docs/source/_modules/torch_ecg/utils/utils_metrics" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for torch_ecg.utils.utils_metrics</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Utilities for computing metrics.</span>

<span class="sd">NOTE that only the widely used metrics are implemented here,</span>
<span class="sd">challenge (e.g. CinC, CPSC series) specific metrics are not included.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">numbers</span> <span class="kn">import</span> <span class="n">Real</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">einops</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">Tensor</span>

<span class="kn">from</span> <span class="nn">..cfg</span> <span class="kn">import</span> <span class="n">DEFAULTS</span>
<span class="kn">from</span> <span class="nn">.misc</span> <span class="kn">import</span> <span class="n">add_docstring</span>
<span class="kn">from</span> <span class="nn">.utils_data</span> <span class="kn">import</span> <span class="n">ECGWaveForm</span><span class="p">,</span> <span class="n">ECGWaveFormNames</span><span class="p">,</span> <span class="n">masks_to_waveforms</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;top_n_accuracy&quot;</span><span class="p">,</span>
    <span class="s2">&quot;confusion_matrix&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ovr_confusion_matrix&quot;</span><span class="p">,</span>
    <span class="s2">&quot;QRS_score&quot;</span><span class="p">,</span>
    <span class="s2">&quot;metrics_from_confusion_matrix&quot;</span><span class="p">,</span>
    <span class="s2">&quot;compute_wave_delineation_metrics&quot;</span><span class="p">,</span>
<span class="p">]</span>


<div class="viewcode-block" id="top_n_accuracy"><a class="viewcode-back" href="../../../generated/torch_ecg.utils.top_n_accuracy.html#torch_ecg.utils.top_n_accuracy">[docs]</a><span class="k">def</span> <span class="nf">top_n_accuracy</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">n</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute top n accuracy.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    labels : numpy.ndarray or torch.Tensor</span>
<span class="sd">        Labels of class indices,</span>
<span class="sd">        of shape ``(batch_size,)`` or ``(batch_size, d_1, ..., d_m)``.</span>
<span class="sd">    outputs : numpy.ndarray or torch.Tensor</span>
<span class="sd">        Predicted probabilities, of shape ``(batch_size, num_classes)``</span>
<span class="sd">        or ``(batch_size, d_1, ..., d_m, num_classes)``</span>
<span class="sd">        or ``(batch_size, num_classes, d_1, ..., d_m)``.</span>
<span class="sd">    n : int or List[int]</span>
<span class="sd">        Top n to be considered.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    acc : float or dict of float</span>
<span class="sd">        Top n accuracy.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from torch_ecg.cfg import DEFAULTS</span>
<span class="sd">    &gt;&gt;&gt; labels, outputs = DEFAULTS.RNG_randint(0, 9, (100)), DEFAULTS.RNG.uniform(0, 1, (100, 10))  # 100 samples, 10 classes</span>
<span class="sd">    &gt;&gt;&gt; top_n_accuracy(labels, outputs, 3)</span>
<span class="sd">    0.32</span>
<span class="sd">    &gt;&gt;&gt; top_n_accuracy(labels, outputs, [1,3,5])</span>
<span class="sd">    {&#39;top_1_acc&#39;: 0.12, &#39;top_3_acc&#39;: 0.32, &#39;top_5_acc&#39;: 0.52}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">outputs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">labels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;outputs and labels must have the same batch size&quot;</span>
    <span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">,</span> <span class="o">*</span><span class="n">extra_dims</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">ln</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ln</span> <span class="o">=</span> <span class="n">n</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">_n</span> <span class="ow">in</span> <span class="n">ln</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;top_</span><span class="si">{</span><span class="n">_n</span><span class="si">}</span><span class="s2">_acc&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">_n</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># of shape (batch_size, n) or (batch_size, n, d_1, ..., d_n)</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;d_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">extra_dims</span><span class="p">))])</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;batch_size </span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2"> -&gt; batch_size n </span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">correct</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">indices</span> <span class="o">==</span> <span class="n">einops</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">_n</span><span class="p">))</span>
        <span class="n">acc</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">correct</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="n">outputs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">extra_dims</span><span class="p">:</span>
            <span class="n">acc</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">acc</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">/</span> <span class="n">d</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">acc</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">acc</span></div>


<div class="viewcode-block" id="confusion_matrix"><a class="viewcode-back" href="../../../generated/torch_ecg.utils.confusion_matrix.html#torch_ecg.utils.confusion_matrix">[docs]</a><span class="k">def</span> <span class="nf">confusion_matrix</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a binary confusion matrix</span>

<span class="sd">    The columns are ground truth labels and rows are predicted labels.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    labels : numpy.ndarray or torch.Tensor</span>
<span class="sd">        Binary labels, of shape ``(n_samples, n_classes)``,</span>
<span class="sd">        or indices of each label class, of shape ``(n_samples,)``.</span>
<span class="sd">    outputs : numpy.ndarray or torch.Tensor</span>
<span class="sd">        Binary outputs, of shape ``(n_samples, n_classes)``,</span>
<span class="sd">        or indices of each class predicted, of shape ``(n_samples,)``.</span>
<span class="sd">    num_classes : int, optional</span>
<span class="sd">        Number of classes.</span>
<span class="sd">        If `labels` and `outputs` are both of shape ``(n_samples,)``,</span>
<span class="sd">        then `num_classes` must be specified.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cm : numpy.ndarray</span>
<span class="sd">        Confusion matrix, of shape ``(n_classes, n_classes)``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">one_hot_pair</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">outputs</span><span class="p">),</span> <span class="s2">&quot;labels and outputs must have the same shape&quot;</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)]),</span> <span class="s2">&quot;labels must be binary&quot;</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">outputs</span><span class="p">)]),</span> <span class="s2">&quot;outputs must be binary&quot;</span>

    <span class="n">num_samples</span><span class="p">,</span> <span class="n">num_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

    <span class="n">cm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">cm</span></div>


<span class="k">def</span> <span class="nf">one_vs_rest_confusion_matrix</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute binary one-vs-rest confusion matrices.</span>

<span class="sd">    Columns are ground truth labels and rows are predicted labels.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    labels : numpy.ndarray or torch.Tensor</span>
<span class="sd">        Binary labels, of shape ``(n_samples, n_classes)``,</span>
<span class="sd">        or indices of each label class, of shape ``(n_samples,)``.</span>
<span class="sd">    outputs : numpy.ndarray or torch.Tensor</span>
<span class="sd">        Binary outputs, of shape ``(n_samples, n_classes)``,</span>
<span class="sd">        or indices of each class predicted, of shape ``(n_samples,)``.</span>
<span class="sd">    num_classes : int, optional</span>
<span class="sd">        number of classes.</span>
<span class="sd">        If `labels` and `outputs` are both of shape ``(n_samples,)``,</span>
<span class="sd">        then `num_classes` must be specified.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ovr_cm : numpy.ndarray</span>
<span class="sd">        One-vs-rest confusion matrix, of shape ``(n_classes, 2, 2)``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">one_hot_pair</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">outputs</span><span class="p">),</span> <span class="s2">&quot;labels and outputs must have the same shape&quot;</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)]),</span> <span class="s2">&quot;labels must be binary&quot;</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">outputs</span><span class="p">)]),</span> <span class="s2">&quot;outputs must be binary&quot;</span>

    <span class="n">num_samples</span><span class="p">,</span> <span class="n">num_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

    <span class="n">ovr_cm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_classes</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_classes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">outputs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># TP</span>
                <span class="n">ovr_cm</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">outputs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># FP</span>
                <span class="n">ovr_cm</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">outputs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># FN</span>
                <span class="n">ovr_cm</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">outputs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># TN</span>
                <span class="n">ovr_cm</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">ovr_cm</span>


<span class="c1"># alias</span>
<span class="n">ovr_confusion_matrix</span> <span class="o">=</span> <span class="n">one_vs_rest_confusion_matrix</span>


<span class="n">_METRICS_FROM_CONFUSION_MATRIX_PARAMS</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Compute macro </span><span class="si">{metric}</span><span class="s2">, and </span><span class="si">{metrics}</span><span class="s2"> for each class.</span>

<span class="s2">    Parameters</span>
<span class="s2">    ----------</span>
<span class="s2">    labels : numpy.ndarray or torch.Tensor</span>
<span class="s2">        Binary labels, of shape ``(n_samples, n_classes)``,</span>
<span class="s2">        or indices of each label class, of shape ``(n_samples,)``.</span>
<span class="s2">    outputs : numpy.ndarray or torch.Tensor</span>
<span class="s2">        Probability outputs, of shape ``(n_samples, n_classes)``,</span>
<span class="s2">        or binary outputs, of shape ``(n_samples, n_classes)``,</span>
<span class="s2">        or indices of each class predicted, of shape ``(n_samples,)``.</span>
<span class="s2">    num_classes : int, optional</span>
<span class="s2">        Number of classes.</span>
<span class="s2">        If `labels` and `outputs` are both of shape ``(n_samples,)``,</span>
<span class="s2">        then `num_classes` must be specified.</span>
<span class="s2">    weights : numpy.ndarray or torch.Tensor, optional</span>
<span class="s2">        Weights for each class, of shape ``(n_classes,)``,</span>
<span class="s2">        used to compute macro </span><span class="si">{metric}</span><span class="s2">.</span>
<span class="s2">    thr : float, default: 0.5</span>
<span class="s2">        Threshold for binary classification,</span>
<span class="s2">        valid only if `outputs` is of shape ``(n_samples, n_classes)``.</span>
<span class="s2">    fillna : bool or float, default: 0.0</span>
<span class="s2">        If is False, then NaN will be left in the result.</span>
<span class="s2">        If is True, then NaN will be filled with 0.0.</span>
<span class="s2">        If is a float, then NaN will be filled with the specified value.</span>
<span class="s2">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="metrics_from_confusion_matrix"><a class="viewcode-back" href="../../../generated/torch_ecg.utils.metrics_from_confusion_matrix.html#torch_ecg.utils.metrics_from_confusion_matrix">[docs]</a><span class="nd">@add_docstring</span><span class="p">(</span>
    <span class="n">_METRICS_FROM_CONFUSION_MATRIX_PARAMS</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;metrics&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="s2">&quot;metrics&quot;</span><span class="p">),</span>
    <span class="s2">&quot;prepend&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">metrics_from_confusion_matrix</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">fillna</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    metrics : dict</span>
<span class="sd">        Metrics computed from the one-vs-rest confusion matrix.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from torch_ecg.cfg import DEFAULTS</span>
<span class="sd">    &gt;&gt;&gt; # binary labels (100 samples, 10 classes, multi-label)</span>
<span class="sd">    &gt;&gt;&gt; labels = DEFAULTS.RNG_randint(0, 1, (100, 10))</span>
<span class="sd">    &gt;&gt;&gt; # probability outputs (100 samples, 10 classes, multi-label)</span>
<span class="sd">    &gt;&gt;&gt; outputs = DEFAULTS.RNG.random((100, 10))</span>
<span class="sd">    &gt;&gt;&gt; metrics = metrics_from_confusion_matrix(labels, outputs)</span>
<span class="sd">    &gt;&gt;&gt; # binarize outputs (100 samples, 10 classes, multi-label)</span>
<span class="sd">    &gt;&gt;&gt; outputs = DEFAULTS.RNG_randint(0, 1, (100, 10))</span>
<span class="sd">    &gt;&gt;&gt; # would raise</span>
<span class="sd">    &gt;&gt;&gt; # RuntimeWarning: `outputs` is probably binary or categorical, AUC may be incorrect</span>
<span class="sd">    &gt;&gt;&gt; metrics = metrics_from_confusion_matrix(labels, outputs)</span>
<span class="sd">    &gt;&gt;&gt; # categorical outputs (100 samples, 10 classes)</span>
<span class="sd">    &gt;&gt;&gt; outputs = DEFAULTS.RNG_randint(0, 9, (100,))</span>
<span class="sd">    &gt;&gt;&gt; # would raise</span>
<span class="sd">    &gt;&gt;&gt; # RuntimeWarning: `outputs` is probably binary or categorical, AUC may be incorrect</span>
<span class="sd">    &gt;&gt;&gt; metrics = metrics_from_confusion_matrix(labels, outputs)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">outputs_ndim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
    <span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">one_hot_pair</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
    <span class="n">num_samples</span><span class="p">,</span> <span class="n">num_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

    <span class="c1"># probability outputs to binary outputs</span>
    <span class="n">bin_outputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">bin_outputs</span><span class="p">[</span><span class="n">outputs</span> <span class="o">&gt;=</span> <span class="n">thr</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">bin_outputs</span><span class="p">[</span><span class="n">outputs</span> <span class="o">&lt;</span> <span class="n">thr</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;`outputs` is probably binary or categorical, AUC may be incorrect&quot;</span><span class="p">,</span> <span class="ne">RuntimeWarning</span><span class="p">)</span>

    <span class="n">ovr_cm</span> <span class="o">=</span> <span class="n">ovr_confusion_matrix</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">bin_outputs</span><span class="p">)</span>

    <span class="c1"># sens: sensitivity, recall, hit rate, or true positive rate</span>
    <span class="c1"># spec: specificity, selectivity or true negative rate</span>
    <span class="c1"># prec: precision or positive predictive value</span>
    <span class="c1"># npv: negative predictive value</span>
    <span class="c1"># jac: jaccard index, threat score, or critical success index</span>
    <span class="c1"># acc: accuracy</span>
    <span class="c1"># phi: phi coefficient, or matthews correlation coefficient</span>
    <span class="c1"># NOTE: never use repeat here, because it will cause bugs</span>
    <span class="c1"># sens, spec, prec, npv, jac, acc, phi = list(repeat(np.zeros(num_classes), 7))</span>
    <span class="n">sens</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">npv</span><span class="p">,</span> <span class="n">jac</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_classes</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>
    <span class="n">auroc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_classes</span><span class="p">)</span>  <span class="c1"># area under the receiver-operater characteristic curve (ROC AUC)</span>
    <span class="n">auprc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_classes</span><span class="p">)</span>  <span class="c1"># area under the precision-recall curve</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_classes</span><span class="p">):</span>
        <span class="n">tp</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ovr_cm</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">ovr_cm</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">ovr_cm</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">ovr_cm</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sens</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sens</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tp</span> <span class="o">+</span> <span class="n">fp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prec</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prec</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tn</span> <span class="o">+</span> <span class="n">fp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">spec</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">spec</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tn</span> <span class="o">+</span> <span class="n">fn</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">npv</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span> <span class="o">+</span> <span class="n">fn</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">npv</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span> <span class="o">+</span> <span class="n">fp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">jac</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">jac</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
        <span class="n">acc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">tn</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_samples</span>
        <span class="n">phi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">tp</span> <span class="o">*</span> <span class="n">tn</span> <span class="o">-</span> <span class="n">fp</span> <span class="o">*</span> <span class="n">fn</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">tn</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">tn</span> <span class="o">+</span> <span class="n">fn</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">outputs_ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">auroc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">auprc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">continue</span>
        <span class="n">thresholds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">outputs</span><span class="p">[:,</span> <span class="n">k</span><span class="p">])</span>
        <span class="n">thresholds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thresholds</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">thresholds</span> <span class="o">=</span> <span class="n">thresholds</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">num_thresholds</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">thresholds</span><span class="p">)</span>

        <span class="c1"># Initialize the TPs, FPs, FNs, and TNs.</span>
        <span class="n">tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_thresholds</span><span class="p">)</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_thresholds</span><span class="p">)</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_thresholds</span><span class="p">)</span>
        <span class="n">tn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_thresholds</span><span class="p">)</span>
        <span class="n">fn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">labels</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">labels</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Find the indices that result in sorted output values.</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">outputs</span><span class="p">[:,</span> <span class="n">k</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Compute the TPs, FPs, FNs, and TNs for class k across thresholds.</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_thresholds</span><span class="p">):</span>
            <span class="c1"># Initialize TPs, FPs, FNs, and TNs using values at previous threshold.</span>
            <span class="n">tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tp</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">fp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">fp</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">fn</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">tn</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tn</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

            <span class="c1"># Update the TPs, FPs, FNs, and TNs at i-th output value.</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_samples</span> <span class="ow">and</span> <span class="n">outputs</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">thresholds</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">labels</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="p">]:</span>
                    <span class="n">tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">fn</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">tn</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Summarize the TPs, FPs, FNs, and TNs for class k.</span>
        <span class="n">tpr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_thresholds</span><span class="p">)</span>
        <span class="n">tnr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_thresholds</span><span class="p">)</span>
        <span class="n">ppv_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_thresholds</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_thresholds</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">fn</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="n">tpr_</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">tp</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">fn</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tpr_</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">tn</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="n">tnr_</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">tn</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">fp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">tn</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tnr_</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">fp</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="n">ppv_</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">tp</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">fp</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ppv_</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>

        <span class="c1"># Compute AUROC as the area under a piecewise linear function with TPR/</span>
        <span class="c1"># sensitivity (x-axis) and TNR/specificity (y-axis) and AUPRC as the area</span>
        <span class="c1"># under a piecewise constant with TPR/recall (x-axis) and PPV/precision</span>
        <span class="c1"># (y-axis) for class k.</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_thresholds</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">auroc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">tpr_</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tpr_</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">tnr_</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">tnr_</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">auprc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">tpr_</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tpr_</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="n">ppv_</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">fnr</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sens</span>  <span class="c1"># false negative rate, miss rate</span>
    <span class="n">fpr</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">spec</span>  <span class="c1"># false positive rate, fall-out</span>
    <span class="n">fdr</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">prec</span>  <span class="c1"># false discovery rate</span>
    <span class="n">for_</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">npv</span>  <span class="c1"># false omission rate</span>
    <span class="n">plr</span> <span class="o">=</span> <span class="n">sens</span> <span class="o">/</span> <span class="n">fpr</span>  <span class="c1"># positive likelihood ratio</span>
    <span class="n">nlr</span> <span class="o">=</span> <span class="n">fnr</span> <span class="o">/</span> <span class="n">spec</span>  <span class="c1"># negative likelihood ratio</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fpr</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sens</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fpr</span><span class="p">))</span>  <span class="c1"># prevalence threshold</span>
    <span class="n">ba</span> <span class="o">=</span> <span class="p">(</span><span class="n">sens</span> <span class="o">+</span> <span class="n">spec</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># balanced accuracy</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sens</span> <span class="o">*</span> <span class="n">prec</span> <span class="o">/</span> <span class="p">(</span><span class="n">sens</span> <span class="o">+</span> <span class="n">prec</span><span class="p">)</span>  <span class="c1"># f1-measure</span>
    <span class="n">fm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prec</span> <span class="o">*</span> <span class="n">sens</span><span class="p">)</span>  <span class="c1"># fowlkes-mallows index</span>
    <span class="n">bm</span> <span class="o">=</span> <span class="n">sens</span> <span class="o">+</span> <span class="n">spec</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># informedness, bookmaker informedness</span>
    <span class="n">mk</span> <span class="o">=</span> <span class="n">prec</span> <span class="o">+</span> <span class="n">npv</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># markedness</span>
    <span class="n">dor</span> <span class="o">=</span> <span class="n">plr</span> <span class="o">/</span> <span class="n">nlr</span>  <span class="c1"># diagnostic odds ratio</span>

    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_classes</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;sens&quot;</span><span class="p">,</span>  <span class="c1"># sensitivity, recall, hit rate, or true positive rate</span>
        <span class="s2">&quot;spec&quot;</span><span class="p">,</span>  <span class="c1"># specificity, selectivity or true negative rate</span>
        <span class="s2">&quot;prec&quot;</span><span class="p">,</span>  <span class="c1"># precision or positive predictive value</span>
        <span class="s2">&quot;npv&quot;</span><span class="p">,</span>  <span class="c1"># negative predictive value</span>
        <span class="s2">&quot;jac&quot;</span><span class="p">,</span>  <span class="c1"># jaccard index, threat score, or critical success index</span>
        <span class="s2">&quot;acc&quot;</span><span class="p">,</span>  <span class="c1"># accuracy</span>
        <span class="s2">&quot;phi&quot;</span><span class="p">,</span>  <span class="c1"># phi coefficient, or matthews correlation coefficient</span>
        <span class="s2">&quot;fnr&quot;</span><span class="p">,</span>  <span class="c1"># false negative rate, miss rate</span>
        <span class="s2">&quot;fpr&quot;</span><span class="p">,</span>  <span class="c1"># false positive rate, fall-out</span>
        <span class="s2">&quot;fdr&quot;</span><span class="p">,</span>  <span class="c1"># false discovery rate</span>
        <span class="s2">&quot;for_&quot;</span><span class="p">,</span>  <span class="c1"># false omission rate</span>
        <span class="s2">&quot;plr&quot;</span><span class="p">,</span>  <span class="c1"># positive likelihood ratio</span>
        <span class="s2">&quot;nlr&quot;</span><span class="p">,</span>  <span class="c1"># negative likelihood ratio</span>
        <span class="s2">&quot;pt&quot;</span><span class="p">,</span>  <span class="c1"># prevalence threshold</span>
        <span class="s2">&quot;ba&quot;</span><span class="p">,</span>  <span class="c1"># balanced accuracy</span>
        <span class="s2">&quot;f1&quot;</span><span class="p">,</span>  <span class="c1"># f1-measure</span>
        <span class="s2">&quot;fm&quot;</span><span class="p">,</span>  <span class="c1"># fowlkes-mallows index</span>
        <span class="s2">&quot;bm&quot;</span><span class="p">,</span>  <span class="c1"># bookmaker informedness</span>
        <span class="s2">&quot;mk&quot;</span><span class="p">,</span>  <span class="c1"># markedness</span>
        <span class="s2">&quot;dor&quot;</span><span class="p">,</span>  <span class="c1"># diagnostic odds ratio</span>
        <span class="s2">&quot;auroc&quot;</span><span class="p">,</span>  <span class="c1"># area under the receiver-operater characteristic curve (ROC AUC)</span>
        <span class="s2">&quot;auprc&quot;</span><span class="p">,</span>  <span class="c1"># area under the precision-recall curve</span>
    <span class="p">]:</span>
        <span class="n">metrics</span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="c1"># convert to Python float from numpy float if possible</span>
        <span class="n">metrics</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;macro_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">_weights</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">m</span><span class="p">)))</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">fillna</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fillna</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">fillna</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">fillna</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;fillna must be in [0, 1]&quot;</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">metrics</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="n">m</span><span class="p">])]</span> <span class="o">=</span> <span class="n">fillna</span>
            <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="n">m</span><span class="p">]):</span>
                <span class="n">metrics</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">fillna</span>
    <span class="k">return</span> <span class="n">metrics</span></div>


<span class="nd">@add_docstring</span><span class="p">(</span>
    <span class="n">_METRICS_FROM_CONFUSION_MATRIX_PARAMS</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;F1-measure&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="s2">&quot;F1-measures&quot;</span><span class="p">),</span>
    <span class="s2">&quot;prepend&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">f_measure</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">fillna</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    macro_f1 : float</span>
<span class="sd">        Macro-averaged F1-measure.</span>
<span class="sd">    f1 : numpy.ndarray</span>
<span class="sd">        F1-measures for each class, of shape: ``(n_classes,)``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">metrics_from_confusion_matrix</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">thr</span><span class="p">,</span> <span class="n">fillna</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;macro_f1&quot;</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;f1&quot;</span><span class="p">]</span>


<span class="nd">@add_docstring</span><span class="p">(</span>
    <span class="n">_METRICS_FROM_CONFUSION_MATRIX_PARAMS</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;sensitivity&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="s2">&quot;sensitivities&quot;</span><span class="p">),</span>
    <span class="s2">&quot;prepend&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">sensitivity</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">fillna</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    macro_sens : float</span>
<span class="sd">        Macro-averaged sensitivity.</span>
<span class="sd">    sens : numpy.ndarray</span>
<span class="sd">        Sensitivities for each class, of shape ``(n_classes,)``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">metrics_from_confusion_matrix</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">thr</span><span class="p">,</span> <span class="n">fillna</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;macro_sens&quot;</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;sens&quot;</span><span class="p">]</span>


<span class="c1"># aliases</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">sensitivity</span>
<span class="n">true_positive_rate</span> <span class="o">=</span> <span class="n">sensitivity</span>
<span class="n">hit_rate</span> <span class="o">=</span> <span class="n">sensitivity</span>


<span class="nd">@add_docstring</span><span class="p">(</span>
    <span class="n">_METRICS_FROM_CONFUSION_MATRIX_PARAMS</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;precision&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="s2">&quot;precisions&quot;</span><span class="p">),</span>
    <span class="s2">&quot;prepend&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">precision</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">fillna</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    macro_prec : float</span>
<span class="sd">        Macro-averaged precision.</span>
<span class="sd">    prec : numpy.ndarray</span>
<span class="sd">        Precisions for each class, of shape ``(n_classes,)``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">metrics_from_confusion_matrix</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">thr</span><span class="p">,</span> <span class="n">fillna</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;macro_prec&quot;</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;prec&quot;</span><span class="p">]</span>


<span class="c1"># aliases</span>
<span class="n">positive_predictive_value</span> <span class="o">=</span> <span class="n">precision</span>


<span class="nd">@add_docstring</span><span class="p">(</span>
    <span class="n">_METRICS_FROM_CONFUSION_MATRIX_PARAMS</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;specificity&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="s2">&quot;specificities&quot;</span><span class="p">),</span>
    <span class="s2">&quot;prepend&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">specificity</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">fillna</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    macro_spec : float</span>
<span class="sd">        Macro-averaged specificity.</span>
<span class="sd">    spec : numpy.ndarray</span>
<span class="sd">        Specificities for each class, of shape ``(n_classes,)``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">metrics_from_confusion_matrix</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">thr</span><span class="p">,</span> <span class="n">fillna</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;macro_spec&quot;</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;spec&quot;</span><span class="p">]</span>


<span class="c1"># aliases</span>
<span class="n">selectivity</span> <span class="o">=</span> <span class="n">specificity</span>
<span class="n">true_negative_rate</span> <span class="o">=</span> <span class="n">specificity</span>


<span class="nd">@add_docstring</span><span class="p">(</span>
    <span class="n">_METRICS_FROM_CONFUSION_MATRIX_PARAMS</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;AUROC and macro AUPRC&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="s2">&quot;AUPRCs, AUPRCs&quot;</span><span class="p">),</span>
    <span class="s2">&quot;prepend&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">auc</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">fillna</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    macro_auroc : float</span>
<span class="sd">        Macro-averaged AUROC.</span>
<span class="sd">    macro_auprc : float</span>
<span class="sd">        Macro-averaged AUPRC.</span>
<span class="sd">    auprc : numpy.ndarray</span>
<span class="sd">        AUPRCs for each class, of shape ``(n_classes,)``.</span>
<span class="sd">    auprc : numpy.ndarray</span>
<span class="sd">        AUPRCs for each class, of shape ``(n_classes,)``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">outputs</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;outputs must be of shape (n_samples, n_classes) to compute AUC&quot;</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">metrics_from_confusion_matrix</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">thr</span><span class="p">,</span> <span class="n">fillna</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;macro_auroc&quot;</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;macro_auprc&quot;</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;auroc&quot;</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;auprc&quot;</span><span class="p">]</span>


<span class="nd">@add_docstring</span><span class="p">(</span>
    <span class="n">_METRICS_FROM_CONFUSION_MATRIX_PARAMS</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="s2">&quot;accuracies&quot;</span><span class="p">),</span>
    <span class="s2">&quot;prepend&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">accuracy</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">fillna</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    macro_acc : float</span>
<span class="sd">        Macro-averaged accuracy.</span>
<span class="sd">    acc: numpy.ndarray,</span>
<span class="sd">        Accuracies for each class, of shape ``(n_classes,)``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">metrics_from_confusion_matrix</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">thr</span><span class="p">,</span> <span class="n">fillna</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;macro_acc&quot;</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;acc&quot;</span><span class="p">]</span>


<div class="viewcode-block" id="QRS_score"><a class="viewcode-back" href="../../../generated/torch_ecg.utils.QRS_score.html#torch_ecg.utils.QRS_score">[docs]</a><span class="k">def</span> <span class="nf">QRS_score</span><span class="p">(</span>
    <span class="n">rpeaks_truths</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]],</span>
    <span class="n">rpeaks_preds</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]],</span>
    <span class="n">fs</span><span class="p">:</span> <span class="n">Real</span><span class="p">,</span>
    <span class="n">thr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.075</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    QRS accuracy score, proposed in CPSC2019.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rpeaks_truths : array_like</span>
<span class="sd">        array of ground truths of rpeaks locations (indices)</span>
<span class="sd">        from multiple records.</span>
<span class="sd">    rpeaks_preds : array_like</span>
<span class="sd">        predictions of ground truths of rpeaks locations (indices)</span>
<span class="sd">        for multiple records.</span>
<span class="sd">    fs : numbers.Real</span>
<span class="sd">        Sampling frequency of ECG signal</span>
<span class="sd">    thr : float, default 0.075</span>
<span class="sd">        Threshold for a prediction to be truth positive,</span>
<span class="sd">        with units in seconds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rec_acc : float</span>
<span class="sd">        Accuracy of predictions.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rpeaks_truths</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
        <span class="n">rpeaks_preds</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;number of records does not match, truth indicates </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rpeaks_truths</span><span class="p">)</span><span class="si">}</span><span class="s2">, while pred indicates </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rpeaks_preds</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">n_records</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rpeaks_truths</span><span class="p">)</span>
    <span class="n">record_flags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">rpeaks_truths</span><span class="p">),),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">thr_</span> <span class="o">=</span> <span class="n">thr</span> <span class="o">*</span> <span class="n">fs</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">truth_arr</span><span class="p">,</span> <span class="n">pred_arr</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rpeaks_truths</span><span class="p">,</span> <span class="n">rpeaks_preds</span><span class="p">)):</span>
        <span class="n">false_negative</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">false_positive</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_positive</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">extended_truth_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">truth_arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">9.5</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)]))</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">t_ind</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">extended_truth_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">next_t_ind</span> <span class="o">=</span> <span class="n">extended_truth_arr</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pred_arr</span> <span class="o">-</span> <span class="n">t_ind</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">thr_</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">pred_arr</span> <span class="o">&gt;=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">+</span> <span class="n">thr_</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pred_arr</span> <span class="o">&lt;=</span> <span class="n">t_ind</span> <span class="o">-</span> <span class="n">thr_</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">err</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">pred_arr</span> <span class="o">&gt;=</span> <span class="n">t_ind</span> <span class="o">+</span> <span class="n">thr_</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pred_arr</span> <span class="o">&lt;=</span> <span class="n">next_t_ind</span> <span class="o">-</span> <span class="n">thr_</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="n">false_positive</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">true_positive</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">false_positive</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">false_negative</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">false_negative</span> <span class="o">+</span> <span class="n">false_positive</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">record_flags</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">false_negative</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">false_positive</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">record_flags</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="k">elif</span> <span class="n">false_negative</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">false_positive</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">record_flags</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span>

    <span class="n">rec_acc</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">record_flags</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_records</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rec_acc</span></div>


<span class="k">def</span> <span class="nf">one_hot_pair</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]],</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert categorical (of shape ``(n_samples,)``) labels and outputs</span>
<span class="sd">    to binary (of shape ``(n_samples, n_classes)``) labels and outputs if applicable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    labels : numpy.ndarray or torch.Tensor or Sequence[Sequence[int]]</span>
<span class="sd">        Categorical labels of shape ``(n_samples,)``,</span>
<span class="sd">        or categorical labels of length ``(n_samples,)``</span>
<span class="sd">        where each element is a sequence of class indices (multi-label),</span>
<span class="sd">        or binary labels of shape ``(n_samples, n_classes)``.</span>
<span class="sd">    outputs : numpy.ndarray or torch.Tensor or Sequence[Sequence[int]]</span>
<span class="sd">        Categorical outputs of shape ``(n_samples,)`` (single-label),</span>
<span class="sd">        or categorical outputs of length ``(n_samples,)``</span>
<span class="sd">        where each element is a sequence of class indices (multi-label),</span>
<span class="sd">        or binary outputs of shape ``(n_samples, n_classes)``.</span>
<span class="sd">    num_classes : int, optional</span>
<span class="sd">        Number of classes.</span>
<span class="sd">        Required if both `labels` and `outputs` are categorical.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    labels : numpy.ndarray</span>
<span class="sd">        Binary labels of shape ``(n_samples, n_classes)``.</span>
<span class="sd">    outputs: numpy.ndarray</span>
<span class="sd">        Binary outputs of shape ``(n_samples, n_classes)``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">):</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">):</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">num_classes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># determine `num_classes`</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">labels</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">num_classes</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">outputs</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">num_classes</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">num_classes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;num_classes is required if both labels and outputs are categorical&quot;</span>

    <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">num_classes</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">_one_hot_pair</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">_one_hot_pair</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span>


<span class="k">def</span> <span class="nf">_one_hot_pair</span><span class="p">(</span><span class="n">cls_array</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]],</span> <span class="n">shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert categorical array to binary array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cls_array : numpy.ndarray or Sequence[Sequence[int]]</span>
<span class="sd">        Categorical array of shape ``(n_samples,)``,</span>
<span class="sd">        where each element is a sequence of class indices (multi-label),</span>
<span class="sd">        or an integer of class index (single-label).</span>
<span class="sd">    shape: tuple,</span>
<span class="sd">        Shape of binary array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.ndarray</span>
<span class="sd">        Binarized array of `cls_array` of shape ``(n_samples, n_classes)``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cls_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cls_array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cls_array</span>
    <span class="n">bin_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">bin_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">cls_array</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">bin_array</span>


<span class="nd">@add_docstring</span><span class="p">(</span><span class="n">one_hot_pair</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cls_to_bin</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]],</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]],</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Alias of `one_hot_pair`.&quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;`cls_to_bin` is deprecated, use `one_hot_pair` instead&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">one_hot_pair</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>


<div class="viewcode-block" id="compute_wave_delineation_metrics"><a class="viewcode-back" href="../../../generated/torch_ecg.utils.compute_wave_delineation_metrics.html#torch_ecg.utils.compute_wave_delineation_metrics">[docs]</a><span class="k">def</span> <span class="nf">compute_wave_delineation_metrics</span><span class="p">(</span>
    <span class="n">truth_masks</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">pred_masks</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">class_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="n">fs</span><span class="p">:</span> <span class="n">Real</span><span class="p">,</span>
    <span class="n">mask_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;channel_first&quot;</span><span class="p">,</span>
    <span class="n">tol</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Compute metrics for the task of ECG wave delineation</span>
<span class="s2">    (sensitivity, precision, f1_score, mean error and standard deviation of the mean errors)</span>
<span class="s2">    for multiple evaluations.</span>

<span class="s2">    Parameters</span>
<span class="s2">    ----------</span>
<span class="s2">    truth_masks : Sequence[numpy.ndarray]</span>
<span class="s2">        A sequence of ground truth masks,</span>
<span class="s2">        each of which can also hold multiple masks from different samples</span>
<span class="s2">        (differ by record or by lead).</span>
<span class="s2">        Each mask is of shape ``(n_channels, n_timesteps)``</span>
<span class="s2">        or ``(n_timesteps, n_channels)``.</span>
<span class="s2">    pred_masks : Sequence[numpy.ndarray]</span>
<span class="s2">        Predictions corresponding to `truth_masks`,</span>
<span class="s2">        of the same shapes.</span>
<span class="s2">    class_map : dict</span>
<span class="s2">        Class map, mapping names to waves to numbers from 0 to n_classes-1,</span>
<span class="s2">        the keys should contain </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ECGWaveFormNames</span><span class="p">])</span><span class="si">}</span><span class="s2">.</span>
<span class="s2">    fs : numbers.Real</span>
<span class="s2">        Sampling frequency of the signal corresponding to the masks,</span>
<span class="s2">        used to compute the duration of each waveform,</span>
<span class="s2">        and thus the error and standard deviations of errors.</span>
<span class="s2">    mask_format : str, default &quot;channel_first&quot;</span>
<span class="s2">        Format of the mask, one of the following:</span>
<span class="s2">        &quot;channel_last&quot; (alias &quot;lead_last&quot;), or</span>
<span class="s2">        &quot;channel_first&quot; (alias &quot;lead_first&quot;)</span>
<span class="s2">    tol : float, default 0.15</span>
<span class="s2">        Tolerance for the duration of the waveform,</span>
<span class="s2">        with units in seconds.</span>

<span class="s2">    Returns</span>
<span class="s2">    -------</span>
<span class="s2">    scorings : dict</span>
<span class="s2">        scorings of onsets and offsets of pwaves, qrs complexes, twaves.</span>
<span class="s2">        Each scoring is a dict consisting of the following metrics:</span>
<span class="s2">        sensitivity, precision, f1_score, mean_error, standard_deviation</span>

<span class="s2">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">truth_masks</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred_masks</span><span class="p">),</span> <span class="s2">&quot;length of truth_masks and pred_masks should be the same&quot;</span>
    <span class="n">truth_waveforms</span><span class="p">,</span> <span class="n">pred_waveforms</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="c1"># compute for each element</span>
    <span class="k">for</span> <span class="n">tm</span><span class="p">,</span> <span class="n">pm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">truth_masks</span><span class="p">,</span> <span class="n">pred_masks</span><span class="p">):</span>
        <span class="n">n_masks</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">mask_format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;channel_first&quot;</span><span class="p">,</span> <span class="s2">&quot;lead_first&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="n">tm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">new_t</span> <span class="o">=</span> <span class="n">masks_to_waveforms</span><span class="p">(</span><span class="n">tm</span><span class="p">,</span> <span class="n">class_map</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">mask_format</span><span class="p">)</span>
        <span class="n">new_t</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_t</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;lead_</span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_masks</span><span class="p">)]</span>  <span class="c1"># list of list of `ECGWaveForm`s</span>
        <span class="n">truth_waveforms</span> <span class="o">+=</span> <span class="n">new_t</span>

        <span class="n">new_p</span> <span class="o">=</span> <span class="n">masks_to_waveforms</span><span class="p">(</span><span class="n">pm</span><span class="p">,</span> <span class="n">class_map</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">mask_format</span><span class="p">)</span>
        <span class="n">new_p</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_p</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;lead_</span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_masks</span><span class="p">)]</span>  <span class="c1"># list of list of `ECGWaveForm`s</span>
        <span class="n">pred_waveforms</span> <span class="o">+=</span> <span class="n">new_p</span>

    <span class="n">scorings</span> <span class="o">=</span> <span class="n">compute_metrics_waveform</span><span class="p">(</span><span class="n">truth_waveforms</span><span class="p">,</span> <span class="n">pred_waveforms</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scorings</span></div>


<span class="k">def</span> <span class="nf">compute_metrics_waveform</span><span class="p">(</span>
    <span class="n">truth_waveforms</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">ECGWaveForm</span><span class="p">]],</span>
    <span class="n">pred_waveforms</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">ECGWaveForm</span><span class="p">]],</span>
    <span class="n">fs</span><span class="p">:</span> <span class="n">Real</span><span class="p">,</span>
    <span class="n">tol</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    compute the sensitivity, precision, f1_score, mean error</span>
<span class="sd">    and standard deviation of the mean errors,</span>
<span class="sd">    of evaluations on a multiple samples (differ by records, or leads).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    truth_waveforms : Sequence[Sequence[ECGWaveForm]]</span>
<span class="sd">        The ground truth,</span>
<span class="sd">        each element is a sequence of `ECGWaveForm` from the same sample.</span>
<span class="sd">    pred_waveforms : Sequence[Sequence[ECGWaveForm]]</span>
<span class="sd">        The predictions corresponding to `truth_waveforms`,</span>
<span class="sd">        each element is a sequence of :class:`ECGWaveForm` from the same sample.</span>
<span class="sd">    fs : numbers.Real</span>
<span class="sd">        Sampling frequency of the signal corresponding to the waveforms,</span>
<span class="sd">        used to compute the duration of each waveform,</span>
<span class="sd">        and thus the error and standard deviations of errors.</span>
<span class="sd">    tol : float, default 0.15</span>
<span class="sd">        Tolerance for the duration of the waveform,</span>
<span class="sd">        with units in seconds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    scorings : dict</span>
<span class="sd">        Scorings of onsets and offsets of pwaves, qrs complexes, twaves.</span>
<span class="sd">        Each scoring is a dict consisting of the following metrics:</span>
<span class="sd">        sensitivity, precision, f1_score, mean_error, standard_deviation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">truth_positive</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="n">ECGWaveFormNames</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;onset&quot;</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">]})</span>
    <span class="n">false_positive</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="n">ECGWaveFormNames</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;onset&quot;</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">]})</span>
    <span class="n">false_negative</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="n">ECGWaveFormNames</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;onset&quot;</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">]})</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="n">ECGWaveFormNames</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;onset&quot;</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">]})</span>
    <span class="c1"># accumulating results</span>
    <span class="k">for</span> <span class="n">tw</span><span class="p">,</span> <span class="n">pw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">truth_waveforms</span><span class="p">,</span> <span class="n">pred_waveforms</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">_compute_metrics_waveform</span><span class="p">(</span><span class="n">tw</span><span class="p">,</span> <span class="n">pw</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;pwave&quot;</span><span class="p">,</span>
            <span class="s2">&quot;qrs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;twave&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;onset&quot;</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">]:</span>
                <span class="n">truth_positive</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">s</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">][</span><span class="s2">&quot;truth_positive&quot;</span><span class="p">]</span>
                <span class="n">false_positive</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">s</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">][</span><span class="s2">&quot;false_positive&quot;</span><span class="p">]</span>
                <span class="n">false_negative</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">s</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">][</span><span class="s2">&quot;false_negative&quot;</span><span class="p">]</span>
                <span class="n">errors</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">s</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">][</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span>
    <span class="n">scorings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="n">ECGWaveFormNames</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;onset&quot;</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">]:</span>
            <span class="n">tp</span> <span class="o">=</span> <span class="n">truth_positive</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">false_positive</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="n">false_negative</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">errors</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="n">sensitivity</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span> <span class="o">+</span> <span class="n">DEFAULTS</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
            <span class="n">precision</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fp</span> <span class="o">+</span> <span class="n">DEFAULTS</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
            <span class="n">f1_score</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sensitivity</span> <span class="o">*</span> <span class="n">precision</span> <span class="o">/</span> <span class="p">(</span><span class="n">sensitivity</span> <span class="o">+</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">DEFAULTS</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
            <span class="n">mean_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">fs</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">fs</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">scorings</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">sensitivity</span><span class="o">=</span><span class="n">sensitivity</span><span class="p">,</span>
                <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span>
                <span class="n">f1_score</span><span class="o">=</span><span class="n">f1_score</span><span class="p">,</span>
                <span class="n">mean_error</span><span class="o">=</span><span class="n">mean_error</span><span class="p">,</span>
                <span class="n">standard_deviation</span><span class="o">=</span><span class="n">standard_deviation</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">scorings</span>


<span class="k">def</span> <span class="nf">_compute_metrics_waveform</span><span class="p">(</span>
    <span class="n">truths</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ECGWaveForm</span><span class="p">],</span>
    <span class="n">preds</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ECGWaveForm</span><span class="p">],</span>
    <span class="n">fs</span><span class="p">:</span> <span class="n">Real</span><span class="p">,</span>
    <span class="n">tol</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the sensitivity, precision, f1_score, mean error</span>
<span class="sd">    and standard deviation of the mean errors,</span>
<span class="sd">    of evaluations on a single sample (the same record, the same lead)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    truths : Sequence[ECGWaveForm]</span>
<span class="sd">        The ground truth</span>
<span class="sd">    preds : Sequence[ECGWaveForm]</span>
<span class="sd">        The predictions corresponding to `truths`.</span>
<span class="sd">    fs : numbers.Real</span>
<span class="sd">        Sampling frequency of the signal corresponding to the waveforms,</span>
<span class="sd">        used to compute the duration of each waveform,</span>
<span class="sd">        and thus the error and standard deviations of errors.</span>
<span class="sd">    tol : float, default 0.15,</span>
<span class="sd">        Tolerance for the duration of the waveform,</span>
<span class="sd">        with units in seconds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    scorings : dict</span>
<span class="sd">        Scorings of onsets and offsets of pwaves, qrs complexes, twaves.</span>
<span class="sd">        Each scoring is a dict consisting of the following metrics:</span>
<span class="sd">        truth_positive, false_negative, false_positive, errors,</span>
<span class="sd">        sensitivity, precision, f1_score, mean_error, standard_deviation</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pwave_onset_truths</span><span class="p">,</span> <span class="n">pwave_offset_truths</span><span class="p">,</span> <span class="n">pwave_onset_preds</span><span class="p">,</span> <span class="n">pwave_offset_preds</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">[],</span>
        <span class="p">[],</span>
        <span class="p">[],</span>
        <span class="p">[],</span>
    <span class="p">)</span>
    <span class="n">qrs_onset_truths</span><span class="p">,</span> <span class="n">qrs_offset_truths</span><span class="p">,</span> <span class="n">qrs_onset_preds</span><span class="p">,</span> <span class="n">qrs_offset_preds</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">[],</span>
        <span class="p">[],</span>
        <span class="p">[],</span>
        <span class="p">[],</span>
    <span class="p">)</span>
    <span class="n">twave_onset_truths</span><span class="p">,</span> <span class="n">twave_offset_truths</span><span class="p">,</span> <span class="n">twave_onset_preds</span><span class="p">,</span> <span class="n">twave_offset_preds</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">[],</span>
        <span class="p">[],</span>
        <span class="p">[],</span>
        <span class="p">[],</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;truths&quot;</span><span class="p">,</span> <span class="s2">&quot;preds&quot;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">eval</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;onset&quot;</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">]:</span>
                <span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">w</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.append(w.</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="n">scorings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="n">ECGWaveFormNames</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;onset&quot;</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">]:</span>
            <span class="p">(</span>
                <span class="n">truth_positive</span><span class="p">,</span>
                <span class="n">false_negative</span><span class="p">,</span>
                <span class="n">false_positive</span><span class="p">,</span>
                <span class="n">errors</span><span class="p">,</span>
                <span class="n">sensitivity</span><span class="p">,</span>
                <span class="n">precision</span><span class="p">,</span>
                <span class="n">f1_score</span><span class="p">,</span>
                <span class="n">mean_error</span><span class="p">,</span>
                <span class="n">standard_deviation</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">=</span> <span class="n">_compute_metrics_base</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">_truths&quot;</span><span class="p">),</span> <span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">_preds&quot;</span><span class="p">),</span> <span class="n">fs</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>
            <span class="n">scorings</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wave</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">truth_positive</span><span class="o">=</span><span class="n">truth_positive</span><span class="p">,</span>
                <span class="n">false_negative</span><span class="o">=</span><span class="n">false_negative</span><span class="p">,</span>
                <span class="n">false_positive</span><span class="o">=</span><span class="n">false_positive</span><span class="p">,</span>
                <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
                <span class="n">sensitivity</span><span class="o">=</span><span class="n">sensitivity</span><span class="p">,</span>
                <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span>
                <span class="n">f1_score</span><span class="o">=</span><span class="n">f1_score</span><span class="p">,</span>
                <span class="n">mean_error</span><span class="o">=</span><span class="n">mean_error</span><span class="p">,</span>
                <span class="n">standard_deviation</span><span class="o">=</span><span class="n">standard_deviation</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">scorings</span>


<span class="k">def</span> <span class="nf">_compute_metrics_base</span><span class="p">(</span><span class="n">truths</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Real</span><span class="p">],</span> <span class="n">preds</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Real</span><span class="p">],</span> <span class="n">fs</span><span class="p">:</span> <span class="n">Real</span><span class="p">,</span> <span class="n">tol</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Base function for computing the metrics of the onset and offset of a waveform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    truths : Sequence[numbers.Real]</span>
<span class="sd">        Ground truth of indices of corresponding critical points.</span>
<span class="sd">    preds : Sequence[numbers.Real]</span>
<span class="sd">        Predicted indices of corresponding critical points.</span>
<span class="sd">    fs : numbers.Real</span>
<span class="sd">        Sampling frequency of the signal corresponding to the critical points,</span>
<span class="sd">        used to compute the duration of each waveform,</span>
<span class="sd">        and thus the error and standard deviations of errors.</span>
<span class="sd">    tol : float, default 0.15</span>
<span class="sd">        Tolerance for the duration of the waveform,</span>
<span class="sd">        with units in seconds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        Tuple of metrics:</span>
<span class="sd">        truth_positive, false_negative, false_positive, errors,</span>
<span class="sd">        sensitivity, precision, f1_score, mean_error, standard_deviation.</span>
<span class="sd">        See [#dl_seg]_ for more details.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [#dl_seg] Moskalenko, Viktor, Nikolai Zolotykh, and Grigory Osipov.</span>
<span class="sd">                 &quot;Deep Learning for ECG Segmentation.&quot; International Conference on Neuroinformatics.</span>
<span class="sd">                 Springer, Cham, 2019.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_tolerance</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">tol</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">_truths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">truths</span><span class="p">)</span>
    <span class="n">_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
    <span class="n">truth_positive</span><span class="p">,</span> <span class="n">false_positive</span><span class="p">,</span> <span class="n">false_negative</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_included</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">truths</span><span class="p">:</span>
        <span class="n">_pred</span> <span class="o">=</span> <span class="n">_preds</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_preds</span> <span class="o">-</span> <span class="n">point</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">_tolerance</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_pred</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">truth_positive</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_pred</span> <span class="o">-</span> <span class="n">point</span><span class="p">))</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_pred</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">point</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">false_negative</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">n_included</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_pred</span><span class="p">)</span>

    <span class="n">false_positive</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_preds</span><span class="p">)</span> <span class="o">-</span> <span class="n">truth_positive</span>

    <span class="n">sensitivity</span> <span class="o">=</span> <span class="n">truth_positive</span> <span class="o">/</span> <span class="p">(</span><span class="n">truth_positive</span> <span class="o">+</span> <span class="n">false_negative</span> <span class="o">+</span> <span class="n">DEFAULTS</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">truth_positive</span> <span class="o">/</span> <span class="p">(</span><span class="n">truth_positive</span> <span class="o">+</span> <span class="n">false_positive</span> <span class="o">+</span> <span class="n">DEFAULTS</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
    <span class="n">f1_score</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sensitivity</span> <span class="o">*</span> <span class="n">precision</span> <span class="o">/</span> <span class="p">(</span><span class="n">sensitivity</span> <span class="o">+</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">DEFAULTS</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
    <span class="n">mean_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">fs</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">fs</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">truth_positive</span><span class="p">,</span>
        <span class="n">false_negative</span><span class="p">,</span>
        <span class="n">false_positive</span><span class="p">,</span>
        <span class="n">errors</span><span class="p">,</span>
        <span class="n">sensitivity</span><span class="p">,</span>
        <span class="n">precision</span><span class="p">,</span>
        <span class="n">f1_score</span><span class="p">,</span>
        <span class="n">mean_error</span><span class="p">,</span>
        <span class="n">standard_deviation</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, WEN Hao, KANG Jingsu.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> and   using a custom <a href="https://github.com/LinxiFan/Sphinx-theme">theme</a> based on <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.0.30',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/sphinx_highlight.js"></script>
      <script type="text/javascript" src="../../../_static/clipboard.min.js"></script>
      <script type="text/javascript" src="../../../_static/copybutton.js"></script>
      <script type="text/javascript" src="../../../_static/design-tabs.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>